{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/profile.css' %}">
{% endblock %}

{% block content %}
<div class="prof-container py-5">
    <div class="container">
        <div class="row">
            <!-- Боковая панель -->
            <div class="col-lg-4 mb-4">
                <div class="prof-sidebar card">
                    <div class="card-body text-center">
                        <div class="prof-avatar-wrapper mb-3">
                            {% if user.image %}
                                <img src="{{ user.image.url }}" class="prof-avatar-img" alt="Аватар">
                            {% else %}
                                <div class="prof-avatar-placeholder">{{ user.get_initials }}</div>
                            {% endif %}
                        </div>
                        <h4 class="mb-1">{{ user.get_full_name|default:user.username }}</h4>
                        <p class="text-muted mb-3">@{{ user.username }}</p>

                        <form method="post" enctype="multipart/form-data" class="mb-3">
                            {% csrf_token %}
                            <label class="btn prof-btn-outline-primary btn-sm mb-2">
                                <i class="bi bi-camera me-1"></i>Сменить аватар
                                <input type="file" name="image" accept="image/*" hidden>
                            </label>
                            {% if user.image %}
                                <button type="submit" name="delete_avatar" class="btn prof-btn-outline-danger btn-sm">
                                    <i class="bi bi-trash me-1"></i>Удалить
                                </button>
                            {% endif %}
                        </form>

                        <div class="prof-social-links">
                            <a href="#" class="text-muted" data-bs-toggle="tooltip" title="Facebook"><i class="bi bi-facebook"></i></a>
                            <a href="#" class="text-muted" data-bs-toggle="tooltip" title="Instagram"><i class="bi bi-instagram"></i></a>
                            <a href="#" class="text-muted" data-bs-toggle="tooltip" title="Telegram"><i class="bi bi-telegram"></i></a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Основное содержимое -->
            <div class="col-lg-8">
                <div class="prof-form-card card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="bi bi-gear me-2"></i>Настройки профиля</h5>
                    </div>
                    <div class="card-body">
                        <form method="post">
                            {% csrf_token %}
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="prof-form-label">Имя</label>
                                    {{ form.first_name }}
                                    {% if form.first_name.errors %}
                                        <div class="prof-invalid-feedback">
                                            {{ form.first_name.errors|join:", " }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="col-md-6">
                                    <label class="prof-form-label">Фамилия</label>
                                    {{ form.last_name }}
                                    {% if form.last_name.errors %}
                                        <div class="prof-invalid-feedback">
                                            {{ form.last_name.errors|join:", " }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="col-md-6">
                                    <label class="prof-form-label">Email</label>
                                    {{ form.email }}
                                    <small class="prof-form-text">Изменить email можно через поддержку</small>
                                    {% if form.email.errors %}
                                        <div class="prof-invalid-feedback">
                                            {{ form.email.errors|join:", " }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="col-md-6">
                                    <label class="prof-form-label">Телефон</label>
                                    {{ form.phone }}
                                    {% if form.phone.errors %}
                                        <div class="prof-invalid-feedback">
                                            {{ form.phone.errors|join:", " }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="col-12">
                                    <label class="prof-form-label">Дата рождения</label>
                                    {{ form.birth_date }}
                                    {% if form.birth_date.errors %}
                                        <div class="prof-invalid-feedback">
                                            {{ form.birth_date.errors|join:", " }}
                                        </div>
                                    {% endif %}
                                </div>
                                <div class="col-12 mt-4">
                                    <button type="submit" name="save_profile" class="btn prof-btn-primary">
                                        <i class="bi bi-check-circle me-1"></i>Сохранить изменения
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/profile_1.js' %}"></script>
{% endblock %}